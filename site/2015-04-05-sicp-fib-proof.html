<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2015-04-05" />
  <title>SICP Exercise 1.13</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<nav id="mainnav">
  <a href="index.html">Home</a>
</nav>
<header id="title-block-header">
<h1 class="title">SICP Exercise 1.13</h1>
<p class="date">2015-04-05</p>
</header>
<p>The Fibonacci sequence is given by,</p>
<p><span class="math display">\[
Fib(n) = {
   \begin{cases}
    0 &amp; n = 0 \\
    1 &amp; n = 1 \\
    Fib(n - 1) + Fib(n - 2) &amp; n \gt 1
   \end{cases}
}
\]</span></p>
<p>Exercise 1.13 in <a href="https://mitpress.mit.edu/sicp/">SICP</a>
asks you to prove that the <span><span
class="math inline">\(n^{th}\)</span></span> Fibonacci number
<span><span class="math inline">\((n = 0, 1,...)\)</span></span> is
equal to the <em>closest integer</em> to <span><span
class="math inline">\(\frac{ { \phi } ^ { n } } { \sqrt 5
}\)</span></span>, where <span><span class="math inline">\({ \phi } = {
\frac { 1 + { \sqrt 5 } } { 2 } }\)</span></span>. The given hint is to
use <span><span class="math inline">\({ \psi } = { \frac { 1 - { \sqrt 5
} } { 2 } }\)</span></span> to prove that <span><span
class="math inline">\({Fib(n)} = { \frac { {\phi}^{n} - {\psi}^{n} } {
\sqrt 5 } }\)</span></span>.</p>
<p>Some will recognize the constant <span><span
class="math inline">\(\phi\)</span></span> as the <a
href="http://en.wikipedia.org/wiki/Golden_ratio">Golden Ratio</a>. While
knowing this fact allows one to use some useful properties of
<span><span class="math inline">\(\phi\)</span></span> and <span><span
class="math inline">\(\psi\)</span></span>, I am not going to use them
in my proof.</p>
We will first prove by induction that
<div>
<p><span class="math display">\[
{Fib(n)} = { \frac { {\phi}^{n} - {\psi}^{n} } { \sqrt 5 } }
\]</span></p>
</div>
And then use this result to prove that
<div>
<p><span class="math display">\[
{Fib(n)} = nint \left( { \frac{ { \phi } ^ { n } } { \sqrt 5 } } \right)
\]</span></p>
</div>
<p>Where <span><span class="math display">\[ nint(x) \]</span></span> is
the nearest integer to <span><span class="math display">\[
x \]</span></span>.</p>
<h2 id="inductive-base-cases">Inductive base cases</h2>
<p>For <span class="math inline">\(n = 0\)</span>, <span
class="math display">\[
{ \frac { {\phi}^{n} - {\psi}^{n} } { \sqrt 5 } }
= { \frac { {\phi}^{0} - {\psi}^{0} } { \sqrt 5 } } = { \frac { 1 - 1 }
{ \sqrt 5 } } = 0 = { Fib(0) }
\]</span></p>
<p>For <span class="math inline">\(n = 1\)</span>, <span
class="math display">\[
{ \frac { {\phi}^{n} - {\psi}^{n} } { \sqrt 5 } }
= { \frac { {\phi}^{1} - {\psi}^{1} } { \sqrt 5 } }
= { \frac { {\phi} - {\psi} } { \sqrt 5 } }
= { \frac { { \frac { 1 + { \sqrt 5 } } { 2 } } - { \frac { 1 - { \sqrt
5 } } { 2 } } } { \sqrt 5 } }
= { \frac { 2 { \sqrt 5 } } { 2 { \sqrt 5 } } }
= 1 = { Fib(1) }
\]</span></p>
<p>For $ n = 2 <span class="math inline">\(,\)</span>$ { { } } = { { } }
= { { } } = { { 4} } = { { 4 { } } } = 1 = { Fib(2) } $$</p>
<h2 id="inductive-step">Inductive step</h2>
<p>Assume that the relation we seek to prove holds for <span>$ n = m
$</span> and $ n = m - 1 $ for some $ m $. That is,</p>
<p><span class="math display">\[
Fib(m) = { \frac { {\phi}^{m} - {\psi}^{m} } { \sqrt 5 } },
Fib(m-1) = { \frac { {\phi}^{m-1} - {\psi}^{m-1} } { \sqrt 5 } }
\]</span></p>
<p><em>We need to prove</em> that, <span class="math display">\[
Fib(m+1) = { \frac { {\phi}^{m+1} - {\psi}^{m+1} } { \sqrt 5 } }
\]</span></p>
<p>Now,</p>
<p><span class="math display">\[
Fib(m+1) = Fib(m) + Fib(m-1)
\]</span></p>
<p><span class="math display">\[
= { { \frac { {\phi}^{m} - {\psi}^{m} } { \sqrt 5 } } + { \frac {
{\phi}^{m-1} - {\psi}^{m-1} } { \sqrt 5 } } }
\]</span></p>
<p><span class="math display">\[
= { \frac { \left( {\phi}^{m} + {\phi}^{m-1} \right) - \left( {\psi}^{m}
+ {\psi}^{m-1} \right) } { \sqrt 5 } }
\]</span></p>
<p><span class="math display">\[
= { \frac { {\phi}^{m-1} \left( \phi + 1 \right) - {\psi}^{m-1} \left(
\psi + 1 \right) } { \sqrt 5 }  \tag{1}\label{eq1} }
\]</span></p>
<p>Let’s look at the term <span>$ {}^{m-1} ( + 1 ) $</span>
separately.</p>
<p><span class="math display">\[
{\phi}^{m-1} \left( \phi + 1 \right) \\\\
={\phi}^{m-1} \left( { \frac {1 + \sqrt 5} {2}} + 1 \right) \\\\
={\phi}^{m-1} \left( { \frac {3 + \sqrt 5} {2} } \right)
\]</span></p>
<p>Multiplying numerator and denominator by <span><span
class="math inline">\(2\)</span></span>, we have</p>
<p><span class="math display">\[
{\phi}^{m-1} \left( { \frac {6 + 2\sqrt 5} {4} } \right)
\]</span></p>
<p><span class="math display">\[
={\phi}^{m-1} \left( { \frac {1 + 2\sqrt 5 + 5} {4} } \right) \\\\
={\phi}^{m-1} \left( { \frac {1 + 2\sqrt 5 + {\left( \sqrt 5 \right)} ^
{2} } {4} } \right)
\]</span></p>
<p><span class="math display">\[
={\phi}^{m-1} \frac { { \left( 1 + \sqrt 5 \right) } ^ {2} } { {2}^{2} }
={\phi}^{m-1} { \left( { \frac { 1 + \sqrt 5 } { 2 } } \right) } ^ {2}
\]</span></p>
<p><span class="math display">\[
={\phi}^{m-1} {\phi}^{2}
={\phi}^{m+1}
\]</span></p>
<p>Similarly, it can be deduced that <span>$ {}^{m-1} ( + 1 ) = {}^{m+1}
$</span>.</p>
<p>Now plugging in these values for <span>$ {}^{m-1} ( + 1 ) <span
class="math inline">\(&lt;/span&gt; and &lt;span&gt;\)</span> {}^{m-1} (
+ 1 ) $</span> in <span class="math inline">\(\ref{eq1}\)</span>, we
have</p>
<p><span class="math display">\[
{ \frac { {\phi}^{m-1} \left( \phi + 1 \right) - {\psi}^{m-1} \left(
\psi + 1 \right) } { \sqrt 5 } }
\]</span></p>
<p><span class="math display">\[
={ \frac { {\phi}^{m+1} - {\psi}^{m+1} } { \sqrt 5 } }
\]</span></p>
<p>Hence, we have just proved that <span>$ Fib(m+1) = { { } } <span
class="math inline">\(&lt;/span&gt;, which
completes our inductive proof of the relation &lt;span&gt;\)</span>
Fib(n) = { { } } $</span>.</p>
<h2 id="final-proof">Final proof</h2>
<p>Now to prove that <span>$ Fib(n) = nint ( { } ) $ </span>. Note that
when we say <span><span class="math inline">\(N\)</span></span> is the
nearest integer to <span><span class="math inline">\(x\)</span></span>,
we are implying that <span>$ N - x &lt; <span
class="math inline">\(&lt;/span&gt;. We
have already proved that &lt;span&gt;\)</span> Fib(n) = { { } }
$</span>. Or,</p>
<p><span class="math display">\[
Fib(n) = \frac{ {\phi}^{n} } { \sqrt 5 } - \frac{ {\psi}^{n} } { \sqrt 5
}
\]</span></p>
<p>or,</p>
<p><span class="math display">\[
Fib(n) - \frac{ {\phi}^{n} } { \sqrt 5 } = \frac{ {\psi}^{n} } { \sqrt 5
}
\]</span></p>
<p>Taking absolute value on both sides,</p>
<p><span class="math display">\[
\lvert { Fib(n) - \frac{ {\phi}^{n} } { \sqrt 5 } } \rvert = \lvert
\frac{ {\psi}^{n} } { \sqrt 5 } \rvert
\]</span></p>
<p>As noted before, if <span>$ Fib(n) <span
class="math inline">\(&lt;/span&gt; is the nearest integer to
&lt;span&gt;\)</span> { } <span class="math inline">\(&lt;/span&gt;, the
absolute value of their
difference must be less than &lt;span&gt;\)</span> $</span>. That
is,</p>
<div>
<p><span class="math display">\[
\lvert { Fib(n) - \frac{ {\phi}^{n} } { \sqrt 5 } } \rvert \lt \frac
{1}{2} \implies \lvert \frac{ {\psi}^{n} } { \sqrt 5 } \rvert \lt \frac
{1}{2}
\]</span></p>
</div>
<p>So, to prove that <span>$ Fib(n) = nint ( { } ) <span
class="math inline">\(&lt;/span&gt;, it suffices to prove that
&lt;span&gt;\)</span> { } $</span>.</p>
<p>Let’s print out the first 10 values of <span><span
class="math display">\[ \lvert \frac { {\psi}^{n} } {\sqrt 5} \rvert
\]</span></span> for <span>$ n = (0,1…9) $</span>.</p>
<pre><code>&gt; (map (lambda (n)
         (abs (/ (^ psi n)
                 (sqrt 5))))
       &#39;(0 1 2 3 4 5 6 7 8 9))

;(.4472135954999579 .27639320225002106 .17082039324993692 .10557280900008414
  .06524758424985282 4.0325224750231356e-2 2.4922359499621467e-2 1.5402865250609892e-2
  .00951949424901158 5.883371001598312e-3)</code></pre>
<p>Clearly, these are all less than <span>$ 0.5 $</span>. But we can
prove this fact using induction.</p>
<p>For <span>$ n = 0 $</span>,</p>
<div>
<p><span class="math display">\[
\lvert \frac { {\psi}^{n} } { \sqrt 5 } \rvert
= \lvert \frac { {\psi}^{0} } { \sqrt 5 } \rvert
= \frac {1}{\sqrt 5}  = \frac {1}{ {2}^{+} } \lt \frac {1}{2}
\]</span></p>
</div>
<p>Here, we used that fact that <span><span class="math inline">\(\sqrt
5 \gt \sqrt 4\)</span></span>. We do not need the exact value of
<span><span class="math inline">\(\sqrt 5\)</span></span>. We just need
to know that it is greater than 2, but not 3, which we write as <span>$
{2}^{+} <span class="math inline">\(&lt;/span&gt;. This means that the
fraction &lt;span&gt;\)</span> $</span> has a denominator of more than
<span><span class="math inline">\(2\)</span></span>, making the fraction
itself less than <span><span class="math inline">\(\frac
{1}{2}\)</span></span>.</p>
<p>For <span>$ n = 1 $</span>,</p>
<div>
<p><span class="math display">\[
\lvert \frac { {\psi}^{n} } { \sqrt 5 } \rvert
= \lvert \frac {\psi} { \sqrt 5 } \rvert
= \lvert \frac { \frac {1 - \sqrt 5} {2} } { \sqrt 5 } \rvert
= \frac {\sqrt 5 - 1} { 2 \sqrt 5 }
= \frac {\sqrt 5 } { 2 \sqrt 5 } - \frac {1} { 2 \sqrt 5}
= \left( \frac {1}{2} - \frac {1} { 2 \sqrt 5} \right) &lt; \frac {1}{2}
(\because \frac {1} {2 \sqrt 5} \gt 0)
\]</span></p>
</div>
<p>Now let us assume that for some <span><span class="math inline">\(n =
m\)</span></span>, <span><span class="math inline">\(\lvert \frac {
{\psi}^{m} } { \sqrt 5 } \rvert \lt \frac {1}{2}\)</span></span>. Using
this, we need to prove that <span><span class="math inline">\(\lvert
\frac { {\psi}^{m+1} } { \sqrt 5 } \rvert \lt \frac
{1}{2}\)</span></span>.</p>
<div>
<p><span class="math display">\[
\lvert \frac { {\psi}^{m+1} } { \sqrt 5 } \rvert
=\lvert \frac { \psi {\psi}^{m} } { \sqrt 5 } \rvert
=\lvert \psi \rvert \lvert \frac { {\psi}^{m} } { \sqrt 5 } \rvert
\]</span></p>
</div>
We know that <span>$ { } <span class="math inline">\(&lt;/span&gt;,
which was
our assumption in the inductive step. But &lt;span&gt;\)</span>
-.6180339887498949 = .6180339887498949 $</span>. A number less than half
times a number less than <span><span
class="math inline">\(1\)</span></span> <em>has</em> to result in a
number less than half. That is, <span><span class="math inline">\({\frac
{1}{2}}^{-} \times {1}^{-} = {\frac {1}{2}}^{-}\)</span></span>. Which
means,
<div>
<span class="math display">\[
\lvert \psi \rvert \lvert \frac { {\psi}^{m} } { \sqrt 5 } \rvert \lt
\frac {1}{2} \because \lvert \psi \rvert \lt 1, \lvert \frac {
{\psi}^{m} } { \sqrt 5 } \rvert \lt \frac {1}{2}
\]</span>
</div>
<p>.</p>
This completes our proof of the relation <span>$ { } n <span
class="math inline">\(&lt;/span&gt;. Which immediately leads to the
final proof that,
&lt;div&gt;\)</span>$ Fib(n) = nint(), n $$
</div>
</body>
</html>
